---
title: "Profit Maximisation and Competitive Markets"
date: "September 29, 2015"
output: html_document
---

Price is given by 

$$P=90-2Q$$  

Total cost is given by

$$Cost=100+2Q^2$$

Total revenue is given by

$$Revenue=P*Q=90Q-2Q^2$$

Marginal cost and marginal revenue are calculated by

$$Value_{q+1}-Value_q,$$

that is, the difference between the value at the current quantity and the value for an additional unit of quantity.

Profit is given by

$$Revenue-Cost$$

```{r message=FALSE,warning=FALSE}
#load some libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(knitr)

#define the price and cost functions
price <- function(q) {
  return( 90 - 2*q )
}

cost <- function(q) {
  return(100+2*q^2)
}

#create a dataframe with quantity going from 0 to 20, and calculate the other variables for each q
market <- data.frame(
  quantity=c(0:20)
  ) %>%
  mutate(
    price = price(quantity),
    cost = cost(quantity),
    mar_cost = lead(cost)-cost,
    total_revenue_monopoly = price*quantity,
    marginal_revenue = lead(total_revenue_monopoly)-total_revenue_monopoly,
    profit_monopoly = total_revenue_monopoly - cost,
    average_costs = cost / quantity
    #simple_marginal_revenue = total_revenue-lag(total_revenue)
  )

```

In a table showing quantity from 1 to 20 we can see values for all our variables:

```{r}

kable(market)

```


Here is what we happen when we plot them

```{r message=FALSE,warning=FALSE}
#gather the variables into two columns, variable and value
marketNarrow <- market %>%
gather(variable,value,price:average_costs)

#plot value against quantity, grouping by variable
ggplot(marketNarrow,aes(quantity,value,colour=variable)) + geom_line() 

#remove total revenue and cost for better scale
ggplot(filter(
  marketNarrow,variable != "total_revenue_monopoly" & variable != "cost"
  ), aes(quantity,value,colour=variable)) + geom_line()

ggplot(filter(
  marketNarrow,variable != "total_revenue_monopoly" & variable != "cost" & variable != "profit_monopoly"
  ), aes(quantity,value,colour=variable)) + geom_line()



```
