---
title: "Profit Maximisation and Competitive Markets"
date: "September 29, 2015"
output: html_document
---

Using the given functions $P=90-2q$ and $Cost=100+2q^2$ to work out price and total cost. I then multiply price by quantity to get total revenue. I calculate marginal cost and marginal revenue simply as the value for quantity plus one minus the value for quantity $Value_{q+1}-Value_q$. This is what I thought was the intuitive definition of marginal cost or marginal revenue, the additional cost or revenue of producing one more item.

```{r message=FALSE,warning=FALSE}
#load some libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(knitr)

#define the price and cost functions
price <- function(q) {
  return( 90 - 2*q )
}

cost <- function(q) {
  return(100+2*q^2)
}

#create a dataframe with quantity going from 0 to 20, and calculate the other variables for each q
market <- data.frame(
  quantity=c(0:20)
  ) %>%
  mutate(
    price = price(quantity),
    cost = cost(quantity),
    simple_mar_cost = lead(cost)-cost,
    total_revenue = price*quantity,
    simple_marginal_revenue = lead(total_revenue)-total_revenue
    #simple_marginal_revenue = total_revenue-lag(total_revenue)
  )

```

The marginal values don't correspond with the values we calculated by deriving the equations

```{r}

kable(market)

```


The graph is broadly right but is off by a small amount in the marginal variables

```{r message=FALSE,warning=FALSE}
#gather the variables into two columns, variable and value
marketNarrow <- market %>%
gather(variable,value,price:simple_marginal_revenue)

#plot value against quantity, grouping by variable
ggplot(marketNarrow,aes(quantity,value,colour=variable)) + geom_line() + ylim(c(0,200))

```
